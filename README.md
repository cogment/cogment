# Cogment Activity Logger

[![Latest Release](https://img.shields.io/docker/v/cogment/model-registry?label=docker%20release&sort=semver&style=flat-square)](https://hub.docker.com/r/cogment/model-registry) [![Apache 2 License](https://img.shields.io/badge/license-Apache%202-green?style=flat-square)](./LICENSE) [![Changelog](https://img.shields.io/badge/-Changelog%20-blueviolet?style=flat-square)](./CHANGELOG.md)

[Cogment](https://cogment.ai) is an innovative open source AI platform designed to leverage the advent of AI to benefit humankind through human-AI collaboration developed by [AI Redefined](https://ai-r.com). Cogment enables AI researchers and engineers to build, train and operate AI agents in simulated or real environments shared with humans. For the full user documentation visit <https://docs.cogment.ai>

This module, Cogment Activity Logger, is a intermediate storage dedicated to the logging of activity data generated by trials run with Cogment.

## Usage

```console
$ docker run -p 9000:9000 cogment/activity-logger
```

### Configuration

The following environment variables can be used to configure the server:

- `COGMENT_ACTIVITY_LOGGER_PORT`: The port to listen on. Defaults to 9000.
- `COGMENT_ACTIVITY_LOGGER_TRIAL_SAMPLE_CAPACITY`: How many samples will be hold in memory. Defaults to 1000.
- `COGMENT_ACTIVITY_LOGGER_GRPC_REFLECTION`: Set to start a [gRPC reflection server](https://github.com/grpc/grpc/blob/master/doc/server-reflection.md). Defaults to `false`.

## API

The Model Registry exposes a two gRPC APIs:

- the [datalog](https://github.com/cogment/cogment-api/blob/main/datalog.proto) API that used by the [Cogment Orchestrator](https://github.com/cogment/cogment-orchestrator) to forward all data generated by running trials.
- the [Activity Logger](grpcapi/cogment/api/activity_logger.proto) API (This will be moved to the Cogment gRPC API in the future) that is used to retrieve the data of a particular trial.

## Developers

### With a local Go installation

Linting is based on the "meta" linter [golangci-lint](https://golangci-lint.run) it needs to be installed locally:

```console
$ make lint
```

Testing:

```console
$ make test
```

Testing with JUnit style reports (for the CI):

```
$ make test-with-report
```

Build a binary in `build/cogment-activity-logger`:

```
$ make build
```

### With Docker

Build image

```
$ ./scripts/build_docker.sh
```
